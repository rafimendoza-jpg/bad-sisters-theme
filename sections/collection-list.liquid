{%- comment -%} Section: Collection List {%- endcomment -%}

<section class="section-padding" data-section-id="{{ section.id }}" data-animate>
  <div class="page-width">
    {%- if section.settings.heading != blank -%}
      <div class="text-center mb-4">
        {%- if section.settings.subheading != blank -%}
          <p style="font-size: 0.8rem; letter-spacing: 0.15em; text-transform: uppercase; color: var(--color-accent); margin-bottom: 0.5rem;">
            {{ section.settings.subheading }}
          </p>
        {%- endif -%}
        <h2>{{ section.settings.heading }}</h2>
      </div>
    {%- endif -%}

    <div class="grid grid--{{ section.settings.columns }}">
      {%- for block in section.blocks -%}
        {%- assign collection = block.settings.collection -%}
        <a href="{{ collection.url | default: '#' }}" class="collection-list-card" {{ block.shopify_attributes }}>
          {%- if block.settings.image != blank -%}
            <img
              src="{{ block.settings.image | image_url: width: 600 }}"
              alt="{{ collection.title | default: block.settings.title }}"
              loading="lazy"
              width="600"
              height="800"
            >
          {%- elsif collection.image != blank -%}
            <img
              src="{{ collection.image | image_url: width: 600 }}"
              alt="{{ collection.title }}"
              loading="lazy"
              width="600"
              height="800"
            >
          {%- else -%}
            {{ 'collection-' | append: forloop.index | placeholder_svg_tag: 'placeholder-svg' }}
          {%- endif -%}

          <div class="collection-list-card__overlay">
            <h3 class="collection-list-card__title">
              {{ block.settings.title | default: collection.title | default: 'Colección' }}
            </h3>
            {%- if collection != blank -%}
              <span class="collection-list-card__count">{{ collection.products_count }} productos</span>
            {%- endif -%}
          </div>
        </a>
      {%- endfor -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Lista de colecciones",
  "settings": [
    {
      "type": "text",
      "id": "subheading",
      "label": "Subtítulo",
      "default": "Explora"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Título",
      "default": "Nuestras colecciones"
    },
    {
      "type": "select",
      "id": "columns",
      "label": "Columnas",
      "options": [
        { "value": "2", "label": "2 columnas" },
        { "value": "3", "label": "3 columnas" },
        { "value": "4", "label": "4 columnas" }
      ],
      "default": "3"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Colección",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Colección"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Imagen personalizada (opcional)"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Título personalizado (opcional)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Lista de colecciones",
      "blocks": [
        { "type": "collection" },
        { "type": "collection" },
        { "type": "collection" }
      ]
    }
  ]
}
{% endschema %}
